<html lang="en">
<head>
<title>Trolltech Qt4 - Marsyas 0.2</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Marsyas 0.2">
<meta name="generator" content="makeinfo 4.8">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Interoperability.html#Interoperability" title="Interoperability">
<link rel="prev" href="Python.html#Python" title="Python">
<link rel="next" href="OCaml.html#OCaml" title="OCaml">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright 1998-2006 George Tzanetakis

Permission is granted to make and distribute verbatim
copies of this manual provided the copyright notice and
this permission notice are preserved on all copies.

Permission is granted to copy and distribute modified
versions of this manual under the conditions for
verbatim copying, provided also that the sections
entitled "Copying" and "GNU General Public License"
are included exactly as in the original, and provided
that the entire resulting derived work is distributed
under the terms of a permission notice identical to this
one.

Permission is granted to copy and distribute
translations of this manual into another language,
under the above conditions for modified versions,
except that this permission notice may be stated in a
translation approved by the Free Software Foundation.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<p>
<a name="Trolltech-Qt4"></a>
Next:&nbsp;<a rel="next" accesskey="n" href="OCaml.html#OCaml">OCaml</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Python.html#Python">Python</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Interoperability.html#Interoperability">Interoperability</a>
<hr>
</div>

<h3 class="section">6.6 Trolltech Qt4</h3>

<p>To get started, look at the tutorial files:

<pre class="verbatim"><!-- Generator: GNU source-highlight 2.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">#  your files</font></i>
SOURCES <font color="#990000">=</font> main<font color="#990000">.</font>cpp
HEADERS <font color="#990000">=</font> mainwindow<font color="#990000">.</font>h
SOURCES <font color="#990000">+=</font> mainwindow<font color="#990000">.</font>cpp
HEADERS <font color="#990000">+=</font> backend<font color="#990000">.</font>h
SOURCES <font color="#990000">+=</font> backend<font color="#990000">.</font>cpp

<i><font color="#9A1900">#  these files are common to every Marsyas/QT app </font></i>
HEADERS <font color="#990000">+=</font> <font color="#990000">../</font>MarSystemQtWrapper<font color="#990000">.</font>h
SOURCES <font color="#990000">+=</font> <font color="#990000">../</font>MarSystemQtWrapper<font color="#990000">.</font>cpp

<i><font color="#9A1900">#  basic system variables</font></i>
TARGET <font color="#990000">=</font> runme
INCLUDEPATH <font color="#990000">+=</font> $<font color="#FF0000">{</font>HOME<font color="#FF0000">}</font><font color="#FF0000">/usr/include/marsyas</font>
unix<font color="#990000">:</font>LIBS <font color="#990000">+=</font> <font color="#990000">-</font>lmarsyas <font color="#990000">-</font><font color="#FF0000">L/usr/local/lib</font> <i><font color="#9A1900"># -lmad -lvorbis -lvorbisfile</font></i>
<font color="#990000">!</font>macx<font color="#990000">:</font>LIBS <font color="#990000">+=</font> <font color="#990000">-</font>lasound
macx<font color="#990000">:</font>LIBS <font color="#990000">+=</font> <font color="#990000">-</font>framework CoreAudio <font color="#990000">-</font>framework CoreMidi <font color="#990000">-</font>framework CoreFoundation

</tt></pre>
</pre>
<pre class="verbatim"><!-- Generator: GNU source-highlight 2.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/*</font></i>
<i><font color="#9A1900">** Copyright (C) 2007 Graham Percival </font></i><u><font color="#0000FF">&lt;gperciva@uvic.ca&gt;</font></u>
<i><font color="#9A1900">**	</font></i>
<i><font color="#9A1900">** This program is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900">** it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900">** the Free Software Foundation; either version 2 of the License, or</font></i>
<i><font color="#9A1900">** (at your option) any later version.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** This program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900">** but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900">** GNU General Public License for more details.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">** along with this program; if not, write to the Free Software </font></i>
<i><font color="#9A1900">** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</font></i>
<i><font color="#9A1900">*/</font></i>

<b><font color="#000080">#include</font></b> <font color="#FF0000">"mainwindow.h"</font>
<font color="#009900">int</font> <b><font color="#000000">main</font></b><font color="#990000">(</font><font color="#009900">int</font> argc<font color="#990000">,</font> <font color="#009900">char</font> <font color="#990000">*</font>argv<font color="#990000">[])</font> <font color="#FF0000">{</font>
<i><font color="#9A1900">// to keep this example as simple as possible, we only take the</font></i>
<i><font color="#9A1900">// filename from the command-line.</font></i>
	string fileName<font color="#990000">;</font> 
	<b><font color="#0000FF">if</font></b> <font color="#990000">(</font>argc<font color="#990000">&lt;</font><font color="#993399">2</font><font color="#990000">)</font> <font color="#FF0000">{</font> cout<font color="#990000">&lt;&lt;</font><font color="#FF0000">"Please enter filename."</font><font color="#990000">&lt;&lt;</font>endl<font color="#990000">;</font> <b><font color="#000000">exit</font></b><font color="#990000">(</font><font color="#993399">1</font><font color="#990000">);</font> <font color="#FF0000">}</font> <b><font color="#0000FF">else</font></b>
		<font color="#FF0000">{</font> fileName <font color="#990000">=</font> argv<font color="#990000">[</font><font color="#993399">1</font><font color="#990000">];</font> <font color="#FF0000">}</font>

	QApplication <b><font color="#000000">app</font></b><font color="#990000">(</font>argc<font color="#990000">,</font> argv<font color="#990000">);</font>
	MarQTwindow <b><font color="#000000">marqt</font></b><font color="#990000">(</font>fileName<font color="#990000">);</font>
	marqt<font color="#990000">.</font><b><font color="#000000">show</font></b><font color="#990000">();</font>
	<b><font color="#0000FF">return</font></b> app<font color="#990000">.</font><b><font color="#000000">exec</font></b><font color="#990000">();</font>
<font color="#FF0000">}</font>

</tt></pre>
</pre>
<pre class="verbatim"><!-- Generator: GNU source-highlight 2.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/*</font></i>
<i><font color="#9A1900">** Copyright (C) 2007 Graham Percival </font></i><u><font color="#0000FF">&lt;gperciva@uvic.ca&gt;</font></u>
<i><font color="#9A1900">**	</font></i>
<i><font color="#9A1900">** This program is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900">** it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900">** the Free Software Foundation; either version 2 of the License, or</font></i>
<i><font color="#9A1900">** (at your option) any later version.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** This program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900">** but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900">** GNU General Public License for more details.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">** along with this program; if not, write to the Free Software </font></i>
<i><font color="#9A1900">** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</font></i>
<i><font color="#9A1900">*/</font></i>

<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;QApplication&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;QPushButton&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;QSlider&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;QVBoxLayout&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;QLCDNumber&gt;</font>

<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;iostream&gt;</font>
<b><font color="#0000FF">using</font></b> <b><font color="#0000FF">namespace</font></b> std<font color="#990000">;</font>

<b><font color="#000080">#include</font></b> <font color="#FF0000">"backend.h"</font>

<b><font color="#0000FF">class</font></b> MarQTwindow <font color="#990000">:</font> <b><font color="#0000FF">public</font></b> QWidget <font color="#FF0000">{</font>
	Q_OBJECT
<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
	<b><font color="#000000">MarQTwindow</font></b><font color="#990000">(</font>string fileName<font color="#990000">);</font>
	<font color="#990000">~</font><b><font color="#000000">MarQTwindow</font></b><font color="#990000">();</font>

<b><font color="#0000FF">public</font></b> slots<font color="#990000">:</font>
	<font color="#009900">void</font> <b><font color="#000000">setMainPosition</font></b><font color="#990000">(</font><font color="#009900">int</font> newPos<font color="#990000">);</font>

<b><font color="#0000FF">private</font></b><font color="#990000">:</font>
	MarBackend <font color="#990000">*</font>marBackend<font color="#990000">;</font>
	QLCDNumber <font color="#990000">*</font>lcd<font color="#990000">;</font>
<font color="#FF0000">}</font><font color="#990000">;</font>

</tt></pre>
</pre>
<pre class="verbatim"><!-- Generator: GNU source-highlight 2.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/*</font></i>
<i><font color="#9A1900">** Copyright (C) 2007 Graham Percival </font></i><u><font color="#0000FF">&lt;gperciva@uvic.ca&gt;</font></u>
<i><font color="#9A1900">**	</font></i>
<i><font color="#9A1900">** This program is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900">** it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900">** the Free Software Foundation; either version 2 of the License, or</font></i>
<i><font color="#9A1900">** (at your option) any later version.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** This program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900">** but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900">** GNU General Public License for more details.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">** along with this program; if not, write to the Free Software </font></i>
<i><font color="#9A1900">** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</font></i>
<i><font color="#9A1900">*/</font></i>

<b><font color="#000080">#include</font></b> <font color="#FF0000">"mainwindow.h"</font>

MarQTwindow<font color="#990000">::</font><b><font color="#000000">MarQTwindow</font></b><font color="#990000">(</font>string fileName<font color="#990000">)</font> <font color="#FF0000">{</font>
<i><font color="#9A1900">// typical Qt front-end</font></i>
	QPushButton <font color="#990000">*</font>quit <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">QPushButton</font></b><font color="#990000">(</font><b><font color="#000000">tr</font></b><font color="#990000">(</font><font color="#FF0000">"Quit"</font><font color="#990000">));</font>
	<b><font color="#000000">connect</font></b><font color="#990000">(</font>quit<font color="#990000">,</font> <b><font color="#000000">SIGNAL</font></b><font color="#990000">(</font><b><font color="#000000">clicked</font></b><font color="#990000">()),</font> qApp<font color="#990000">,</font> <b><font color="#000000">SLOT</font></b><font color="#990000">(</font><b><font color="#000000">quit</font></b><font color="#990000">()));</font>

	QPushButton <font color="#990000">*</font>updatePos <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">QPushButton</font></b><font color="#990000">(</font><b><font color="#000000">tr</font></b><font color="#990000">(</font><font color="#FF0000">"Update position"</font><font color="#990000">));</font>

	QSlider <font color="#990000">*</font>volume <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">QSlider </font></b><font color="#990000">(</font>Qt<font color="#990000">::</font>Horizontal<font color="#990000">);</font>
	volume<font color="#990000">-&gt;</font><b><font color="#000000">setRange</font></b><font color="#990000">(</font><font color="#993399">0</font><font color="#990000">,</font><font color="#993399">100</font><font color="#990000">);</font>
	volume<font color="#990000">-&gt;</font><b><font color="#000000">setValue</font></b><font color="#990000">(</font><font color="#993399">50</font><font color="#990000">);</font>

	lcd <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">QLCDNumber</font></b><font color="#990000">();</font>
	lcd<font color="#990000">-&gt;</font><b><font color="#000000">setNumDigits</font></b><font color="#990000">(</font><font color="#993399">10</font><font color="#990000">);</font>

	QVBoxLayout <font color="#990000">*</font>layout <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> QVBoxLayout<font color="#990000">;</font>
	layout<font color="#990000">-&gt;</font><b><font color="#000000">addWidget</font></b><font color="#990000">(</font>volume<font color="#990000">);</font>
	layout<font color="#990000">-&gt;</font><b><font color="#000000">addWidget</font></b><font color="#990000">(</font>updatePos<font color="#990000">);</font>
	layout<font color="#990000">-&gt;</font><b><font color="#000000">addWidget</font></b><font color="#990000">(</font>lcd<font color="#990000">);</font>
	layout<font color="#990000">-&gt;</font><b><font color="#000000">addWidget</font></b><font color="#990000">(</font>quit<font color="#990000">);</font>
	<b><font color="#000000">setLayout</font></b><font color="#990000">(</font>layout<font color="#990000">);</font>

<i><font color="#9A1900">// make the Marsyas backend</font></i>
	marBackend <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">MarBackend</font></b><font color="#990000">();</font>
	marBackend<font color="#990000">-&gt;</font><b><font color="#000000">openBackendSoundfile</font></b><font color="#990000">(</font>fileName<font color="#990000">);</font>

<i><font color="#9A1900">// make connections between the Qt front-end and the Marsyas backend:</font></i>

<i><font color="#9A1900">//		Qt -&gt; Marsyas</font></i>
	<b><font color="#000000">connect</font></b><font color="#990000">(</font>volume<font color="#990000">,</font> <b><font color="#000000">SIGNAL</font></b><font color="#990000">(</font><b><font color="#000000">valueChanged</font></b><font color="#990000">(</font><font color="#009900">int</font><font color="#990000">)),</font>
			marBackend<font color="#990000">,</font> <b><font color="#000000">SLOT</font></b><font color="#990000">(</font><b><font color="#000000">setBackendVolume</font></b><font color="#990000">(</font><font color="#009900">int</font><font color="#990000">)));</font>

<i><font color="#9A1900">//		Marsyas -&gt; Qt</font></i>
	<b><font color="#000000">connect</font></b><font color="#990000">(</font>marBackend<font color="#990000">,</font> <b><font color="#000000">SIGNAL</font></b><font color="#990000">(</font><b><font color="#000000">changedBackendPosition</font></b><font color="#990000">(</font><font color="#009900">int</font><font color="#990000">)),</font>
			<b><font color="#0000FF">this</font></b><font color="#990000">,</font> <b><font color="#000000">SLOT</font></b><font color="#990000">(</font><b><font color="#000000">setMainPosition</font></b><font color="#990000">(</font><font color="#009900">int</font><font color="#990000">)));</font>

<i><font color="#9A1900">//		Qt -&gt; Marsyas (getBackendPosition) -&gt; Qt (changedBackendPosition)</font></i>
	<b><font color="#000000">connect</font></b><font color="#990000">(</font>updatePos<font color="#990000">,</font> <b><font color="#000000">SIGNAL</font></b><font color="#990000">(</font><b><font color="#000000">clicked</font></b><font color="#990000">()),</font>
			marBackend<font color="#990000">,</font> <b><font color="#000000">SLOT</font></b><font color="#990000">(</font><b><font color="#000000">getBackendPosition</font></b><font color="#990000">()));</font>
<font color="#FF0000">}</font>

MarQTwindow<font color="#990000">::~</font><b><font color="#000000">MarQTwindow</font></b><font color="#990000">()</font> <font color="#FF0000">{</font>
	<b><font color="#0000FF">delete</font></b> marBackend<font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> MarQTwindow<font color="#990000">::</font><b><font color="#000000">setMainPosition</font></b><font color="#990000">(</font><font color="#009900">int</font> newPos<font color="#990000">)</font> <font color="#FF0000">{</font>
	lcd<font color="#990000">-&gt;</font><b><font color="#000000">display</font></b><font color="#990000">(</font>newPos<font color="#990000">);</font>
<font color="#FF0000">}</font>

</tt></pre>
</pre>
<pre class="verbatim"><!-- Generator: GNU source-highlight 2.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/*</font></i>
<i><font color="#9A1900">** Copyright (C) 2007 Graham Percival </font></i><u><font color="#0000FF">&lt;gperciva@uvic.ca&gt;</font></u>
<i><font color="#9A1900">**	</font></i>
<i><font color="#9A1900">** This program is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900">** it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900">** the Free Software Foundation; either version 2 of the License, or</font></i>
<i><font color="#9A1900">** (at your option) any later version.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** This program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900">** but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900">** GNU General Public License for more details.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">** along with this program; if not, write to the Free Software </font></i>
<i><font color="#9A1900">** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</font></i>
<i><font color="#9A1900">*/</font></i>

<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;QObject&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;QTimer&gt;</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">"MarSystemManager.h"</font>
<b><font color="#000080">#include</font></b> <font color="#FF0000">"../MarSystemQtWrapper.h"</font>

<b><font color="#000080">#include</font></b> <font color="#FF0000">&lt;iostream&gt;</font>
<b><font color="#0000FF">using</font></b> <b><font color="#0000FF">namespace</font></b> std<font color="#990000">;</font>
<b><font color="#0000FF">using</font></b> <b><font color="#0000FF">namespace</font></b> Marsyas<font color="#990000">;</font>

<b><font color="#0000FF">class</font></b> MarBackend<font color="#990000">:</font> <b><font color="#0000FF">public</font></b> QObject <font color="#FF0000">{</font>
	Q_OBJECT

<b><font color="#0000FF">public</font></b><font color="#990000">:</font>
	<b><font color="#000000">MarBackend</font></b><font color="#990000">();</font>
	<font color="#990000">~</font><b><font color="#000000">MarBackend</font></b><font color="#990000">();</font>
	<font color="#009900">void</font> <b><font color="#000000">openBackendSoundfile</font></b><font color="#990000">(</font>string fileName<font color="#990000">);</font>

<b><font color="#0000FF">public</font></b> slots<font color="#990000">:</font>
	<font color="#009900">void</font> <b><font color="#000000">setBackendVolume</font></b><font color="#990000">(</font><font color="#009900">int</font> value<font color="#990000">);</font>
	<font color="#009900">void</font> <b><font color="#000000">getBackendPosition</font></b><font color="#990000">();</font>

signals<font color="#990000">:</font>
	<font color="#009900">void</font> <b><font color="#000000">changedBackendPosition</font></b><font color="#990000">(</font><font color="#009900">int</font> value<font color="#990000">);</font>

<b><font color="#0000FF">private</font></b><font color="#990000">:</font>
<i><font color="#9A1900">// in order to make the MarSystem act like a Qt object,</font></i>
<i><font color="#9A1900">// we use this wrapper:</font></i>
	MarSystemQtWrapper <font color="#990000">*</font>mrsWrapper<font color="#990000">;</font>
<i><font color="#9A1900">// ... and these pointers:</font></i>
	MarControlPtr filenamePtr<font color="#990000">;</font>
	MarControlPtr gainPtr<font color="#990000">;</font>
	MarControlPtr positionPtr<font color="#990000">;</font>

<i><font color="#9A1900">// typical Marsyas network:</font></i>
	MarSystem <font color="#990000">*</font>playbacknet<font color="#990000">;</font>
<font color="#FF0000">}</font><font color="#990000">;</font>

</tt></pre>
</pre>
<pre class="verbatim"><!-- Generator: GNU source-highlight 2.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><i><font color="#9A1900">/*</font></i>
<i><font color="#9A1900">** Copyright (C) 2007 Graham Percival </font></i><u><font color="#0000FF">&lt;gperciva@uvic.ca&gt;</font></u>
<i><font color="#9A1900">**	</font></i>
<i><font color="#9A1900">** This program is free software; you can redistribute it and/or modify</font></i>
<i><font color="#9A1900">** it under the terms of the GNU General Public License as published by</font></i>
<i><font color="#9A1900">** the Free Software Foundation; either version 2 of the License, or</font></i>
<i><font color="#9A1900">** (at your option) any later version.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** This program is distributed in the hope that it will be useful,</font></i>
<i><font color="#9A1900">** but WITHOUT ANY WARRANTY; without even the implied warranty of</font></i>
<i><font color="#9A1900">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font></i>
<i><font color="#9A1900">** GNU General Public License for more details.</font></i>
<i><font color="#9A1900">** </font></i>
<i><font color="#9A1900">** You should have received a copy of the GNU General Public License</font></i>
<i><font color="#9A1900">** along with this program; if not, write to the Free Software </font></i>
<i><font color="#9A1900">** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</font></i>
<i><font color="#9A1900">*/</font></i>

<b><font color="#000080">#include</font></b> <font color="#FF0000">"backend.h"</font>
<b><font color="#0000FF">using</font></b> <b><font color="#0000FF">namespace</font></b> Marsyas<font color="#990000">;</font>

MarBackend<font color="#990000">::</font><b><font color="#000000">MarBackend</font></b><font color="#990000">()</font> <font color="#FF0000">{</font>
<i><font color="#9A1900">// make a typical Marsyas network:</font></i>
	MarSystemManager mng<font color="#990000">;</font>
	playbacknet <font color="#990000">=</font> mng<font color="#990000">.</font><b><font color="#000000">create</font></b><font color="#990000">(</font><font color="#FF0000">"Series"</font><font color="#990000">,</font> <font color="#FF0000">"playbacknet"</font><font color="#990000">);</font>
	playbacknet<font color="#990000">-&gt;</font><b><font color="#000000">addMarSystem</font></b><font color="#990000">(</font>mng<font color="#990000">.</font><b><font color="#000000">create</font></b><font color="#990000">(</font><font color="#FF0000">"SoundFileSource"</font><font color="#990000">,</font> <font color="#FF0000">"src"</font><font color="#990000">));</font>
	playbacknet<font color="#990000">-&gt;</font><b><font color="#000000">addMarSystem</font></b><font color="#990000">(</font>mng<font color="#990000">.</font><b><font color="#000000">create</font></b><font color="#990000">(</font><font color="#FF0000">"Gain"</font><font color="#990000">,</font> <font color="#FF0000">"gain"</font><font color="#990000">));</font>
	playbacknet<font color="#990000">-&gt;</font><b><font color="#000000">addMarSystem</font></b><font color="#990000">(</font>mng<font color="#990000">.</font><b><font color="#000000">create</font></b><font color="#990000">(</font><font color="#FF0000">"AudioSink"</font><font color="#990000">,</font> <font color="#FF0000">"dest"</font><font color="#990000">));</font>
	playbacknet<font color="#990000">-&gt;</font><b><font color="#000000">updctrl</font></b><font color="#990000">(</font><font color="#FF0000">"AudioSink/dest/mrs_bool/initAudio"</font><font color="#990000">,</font> <b><font color="#0000FF">true</font></b><font color="#990000">);</font>

<i><font color="#9A1900">// wrap it up to make it pretend to be a Qt object:</font></i>
	mrsWrapper <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">MarSystemQtWrapper</font></b><font color="#990000">(</font>playbacknet<font color="#990000">);</font>
	mrsWrapper<font color="#990000">-&gt;</font><b><font color="#000000">start</font></b><font color="#990000">();</font>

<i><font color="#9A1900">// make these pointers so that we can interface with the network</font></i>
<i><font color="#9A1900">// in a thread-safe manner:</font></i>
	filenamePtr <font color="#990000">=</font> mrsWrapper<font color="#990000">-&gt;</font><b><font color="#000000">getctrl</font></b><font color="#990000">(</font><font color="#FF0000">"SoundFileSource/src/mrs_string/filename"</font><font color="#990000">);</font>
	gainPtr <font color="#990000">=</font> mrsWrapper<font color="#990000">-&gt;</font><b><font color="#000000">getctrl</font></b><font color="#990000">(</font><font color="#FF0000">"Gain/gain/mrs_real/gain"</font><font color="#990000">);</font>
	positionPtr <font color="#990000">=</font> mrsWrapper<font color="#990000">-&gt;</font><b><font color="#000000">getctrl</font></b><font color="#990000">(</font><font color="#FF0000">"SoundFileSource/src/mrs_natural/pos"</font><font color="#990000">);</font>

<i><font color="#9A1900">// demonstrates information flow:  Marsyas-&gt;Qt.</font></i>
	QTimer <font color="#990000">*</font>timer <font color="#990000">=</font> <b><font color="#0000FF">new</font></b> <b><font color="#000000">QTimer</font></b><font color="#990000">(</font><b><font color="#0000FF">this</font></b><font color="#990000">);</font>
	<b><font color="#000000">connect</font></b><font color="#990000">(</font>timer<font color="#990000">,</font> <b><font color="#000000">SIGNAL</font></b><font color="#990000">(</font><b><font color="#000000">timeout</font></b><font color="#990000">()),</font> <b><font color="#0000FF">this</font></b><font color="#990000">,</font> <b><font color="#000000">SLOT</font></b><font color="#990000">(</font><b><font color="#000000">getBackendPosition</font></b><font color="#990000">()));</font>
	timer<font color="#990000">-&gt;</font><b><font color="#000000">start</font></b><font color="#990000">(</font><font color="#993399">1000</font><font color="#990000">);</font>
<font color="#FF0000">}</font>

MarBackend<font color="#990000">::~</font><b><font color="#000000">MarBackend</font></b><font color="#990000">()</font> <font color="#FF0000">{</font>
	<b><font color="#0000FF">delete</font></b> mrsWrapper<font color="#990000">;</font>
	<b><font color="#0000FF">delete</font></b> playbacknet<font color="#990000">;</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> MarBackend<font color="#990000">::</font><b><font color="#000000">openBackendSoundfile</font></b><font color="#990000">(</font>string fileName<font color="#990000">)</font> <font color="#FF0000">{</font>
	mrsWrapper<font color="#990000">-&gt;</font><b><font color="#000000">updctrl</font></b><font color="#990000">(</font>filenamePtr<font color="#990000">,</font>fileName<font color="#990000">);</font>
	mrsWrapper<font color="#990000">-&gt;</font><b><font color="#000000">play</font></b><font color="#990000">();</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> MarBackend<font color="#990000">::</font><b><font color="#000000">setBackendVolume</font></b><font color="#990000">(</font><font color="#009900">int</font> vol<font color="#990000">)</font> <font color="#FF0000">{</font>
	<font color="#009900">float</font> newGain <font color="#990000">=</font> vol<font color="#990000">/</font><font color="#993399">100</font><font color="#990000">.</font>0f<font color="#990000">;</font>
	mrsWrapper<font color="#990000">-&gt;</font><b><font color="#000000">updctrl</font></b><font color="#990000">(</font>gainPtr<font color="#990000">,</font> newGain<font color="#990000">);</font>
<font color="#FF0000">}</font>

<font color="#009900">void</font> MarBackend<font color="#990000">::</font><b><font color="#000000">getBackendPosition</font></b><font color="#990000">()</font> <font color="#FF0000">{</font>
	<font color="#009900">int</font> newPos <font color="#990000">=</font> <font color="#990000">(</font><font color="#009900">int</font><font color="#990000">)</font> positionPtr<font color="#990000">-&gt;</font>to<font color="#990000">&lt;</font>mrs_natural<font color="#990000">&gt;();</font>
	emit <b><font color="#000000">changedBackendPosition</font></b><font color="#990000">(</font>newPos<font color="#990000">);</font>
<font color="#FF0000">}</font>

</tt></pre>
</pre>

   <p>After examining that project, see <samp><span class="file">qtGUIs/MarPlayer/</span></samp>, followed by
the other examples in the <samp><span class="file">qtGUIs/</span></samp> directory.

   </body></html>

